function s3(t,e){this.url=t,this.productName=e,this.prefix=this.productName}function getVersions(t,e,i){i($.map(t,function(t){return t.key.split("/")[1]}))}function cmp(t,e){for(var i=t.split("."),n=e.split("."),r=0;3>r;r++){var o=Number(i[r]),s=Number(n[r]);if(o>s)return-1;if(s>o)return 1;if(!isNaN(o)&&isNaN(s))return-1;if(isNaN(o)&&!isNaN(s))return 1}return 0}function bytesToHumanReadable(t){var e=-1,i=[" kB"," MB"," GB"];do t/=1024,e++;while(t>1024);return Math.max(t,.1).toFixed(1)+i[e]}function prettifyFileName(t){switch(split=t.split("-"),split[1]){case"darwin":split[1]="Mac";break;case"win32":split[1]="Windows";break;case"linux":split[1]="Linux"}return split[0]+" for "+split[1]+" "+split[2].substring(0,3)}var controller=new ScrollMagic.Controller,scene=new ScrollMagic.Scene({triggerElement:"#trigger",duration:100}).addTo(controller).on("enter",function(){$("#screen-shot").css("bottom",0)});s3.prototype.getLatestVersion=function(t){getData(this,function(e){getVersions(e.directories,"etcher",function(e){t(e.sort(cmp)[0])})})},s3.prototype.getFiles=function(t,e){this.prefix=this.prefix+"/"+t,getData(this,function(t){e(t.files)})},s3.prototype.getDynamicLink=function(t,e,i,n,r){switch(e){case"macos":buttonText="Download for OSX",r(findLink(t,this.productName+"-darwin",buttonText,n));break;case"windows":buttonText="Download for Windows",r(findLink(t,this.productName+"-win32",buttonText,n));break;case"linux":buttonText="Download for Linux",r(findLink(t,this.productName+"-linux",buttonText,n));break;default:i.mobile=!0,r([i])}};var findLink=function(t,e,i,n){for(var r=[],o=0,s=t.length;s>o;o++)if(-1!=t[o].link.toLowerCase().indexOf(e)&&(t[o].buttonText=i,t[o].eventName=n,r.push(t[o])),o===s-1)return r};getData=function(t,e){query_url=t.url+"?delimiter=/&prefix="+t.prefix+"/",$.get(query_url).done(function(i){var n=$(i);e(parseXML(n,t))}).fail(function(t){console.error(t)})},parseXML=function(t,e){var i=$.map(t.find("Contents"),function(t){t=$(t);var i=t.find("Key").text().split("/")[2];return{name:i,prettyName:prettifyFileName(i),link:e.url+"/"+t.find("Key").text(),lastModified:t.find("LastModified").text(),size:bytesToHumanReadable(t.find("Size").text()),type:"file"}}),n=$.map(t.find("CommonPrefixes"),function(t){return t=$(t),{key:t.find("Prefix").text(),lastModified:"",size:"0",type:"directory"}});return{files:i,directories:n,prefix:$(t.find("Prefix")[0]).text()}};